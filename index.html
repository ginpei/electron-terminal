<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Electron ifconfig</title>
		<style>
html {
	font-size: 8px;
	height: 100%;
}
body {
	box-sizing: border-box;
	height: 100%;
	margin: 0;
	padding: 1rem;
}
#app {
	display: grid;
	grid-template-rows: 3rem auto 2rem;
	grid-gap: 1rem;
	height: 100%;
}
#app button {
	height: 100%;
}
#app .output-row {
	display: flex;
}
#app .output {
	flex: 1;
}
#app .status-row {
}
#app .status-text {
	color: #666;
	font-size: 1.5rem;
	line-height: 2rem;
}
		</style>
	</head>
	<body>
		<div id="app">
			<div class="controller-row">
				<button id="get" disabled>Get</button>
			</div>
			<div class="output-row">
				<textarea id="output" class="output" readonly></textarea>
			</div>
			<div class="status-row">
				<div id="status" class="status-text"></div>
			</div>
		</div>
		<script>
(function() {
	const { ipcRenderer } = require('electron')

	function $(selector) {
		return document.querySelector(selector)
	}

	const elGet = $('#get')
	const elOutput = $('#output')
	const elStatus = $('#status')

	function start() {
		elGet.addEventListener('click', (event) => {
			elGet.disabled = true
			elStatus.textContent = 'Running...'

			ipcRenderer.send('ifconfig.run', { message: 'Hello!' })
		})

		ipcRenderer.on('ifconfig.done', (event, arg) => {
			elGet.disabled = false

			if (arg.code === 0) {
				elStatus.textContent = 'Done.'
				elOutput.value = arg.stdout
			}
			else {
				elStatus.textContent = `Error: ${arg.code}`
				elOutput.value = arg.stderr
			}
		})

		elGet.disabled = false
		elStatus.textContent = 'Ready.'
	}

	start()
})()
		</script>
	</body>
</html>
